---
title: "Do Fast Pit Stops Win F1 Races - or Is It Just Hype?"
editor: visual
---
---
title: "blog"
format: html
editor: visual
---

On lap 37 of the Italian Grand Prix, everything was perfect - clean air, fresh tyres, P1.

Then came the pit stop.
Three seconds too slow.
He rejoined in third.
He never recovered.

In a sport where races last 90 minutes, can three seconds in a pit lane really decide everything?

I used real Formula 1 data to find out — not just with charts, but with statistical modelling, bootstrapping and predictive analysis.

This blog is the investigation.

We’re answering one question:

**Does pit stop speed translate into better race results in a measurable way.**



## Libraries
```{r, libraries, message=FALSE}
library(tidyverse)
library(broom)     
library(rsample)   
```


## Load data
```{r, message=FALSE}

pitstops_df <- read.csv(here::here("data/pit_stops.csv"))

results_df <- read.csv(here::here("data/results.csv"))

race_df <- read.csv(here::here("data/races.csv"))

driver_df <- read.csv(here::here("data/drivers.csv"))

constructor_df <- read.csv(here::here("data/constructors.csv"))

status_df <- read.csv(here::here("data/status.csv"))
```


## Process data
```{r}
drivers_lookup <- driver_df %>%
      mutate(driver_full = paste(forename, surname)) %>%
      select(driverId, driver_full)

races_lookup <- race_df %>%
      mutate(race_full = paste(name, year)) %>%
      select(raceId, race_full, year)

constructors_lookup <- constructor_df %>%
      select(constructorId, constructor_name = name)
    
combined_df <- pitstops_df %>%
  left_join(drivers_lookup, by = "driverId") %>%
  left_join(races_lookup, by = "raceId") %>%
  left_join(
    results_df %>%
      select(raceId, driverId, constructorId, positionOrder, positionText, grid, statusId),
    by = c("raceId", "driverId")) %>%
  
  left_join(constructors_lookup, by = "constructorId") %>%
  left_join(status_df, by = "statusId") %>%
  filter(year %in% c(2011, 2015, 2019, 2024)) %>%
  select(
    driver = driver_full,
    race = race_full,
    year,
    constructor = constructor_name,
    stop,
    lap,
    duration,
    milliseconds,
    positionOrder,
    grid,
    status )

combined_2011 <- combined_df %>%
  filter(year == 2011, milliseconds <= 50000)

combined_2015 <- combined_df %>%
  filter(year == 2015, milliseconds <= 50000)

combined_2019 <- combined_df %>%
  filter(year == 2019, milliseconds <= 50000)

combined_2024 <- combined_df %>%
  filter(year == 2024, milliseconds <= 50000)

```

## Exploratory analysis
```{r}
driver_race_df <- combined_df %>%
  mutate(
    stop_sec = suppressWarnings(as.numeric(duration))) %>%
  drop_na(stop_sec) %>%      
  
  group_by(year, race, driver, constructor, grid, positionOrder) %>%
  summarise(
    best_pit_sec = min(stop_sec, na.rm = TRUE),
    avg_pit_sec  = mean(stop_sec, na.rm = TRUE),
    n_stops      = n(),
    .groups = "drop") %>%
  
  filter(best_pit_sec > 15, best_pit_sec < 60)
```

### Overall distribution (best pit per driver per race, all years):
```{r}
driver_race_df %>%
  ggplot(aes(best_pit_sec)) +
  geom_density(fill = "steelblue", alpha = 0.45) +
  labs(
    title = "Complete pit lane time distribution",
    subtitle = "Most pit cycles fall between 18 and 30 seconds",
    x = "Total pit lane time (seconds)",
    y = "Density"
  ) +
  theme_minimal()
```

## Regression model

```{r}
model_f1 <- lm(
  positionOrder ~ best_pit_sec + grid + constructor,
  data = driver_race_df)

summary(model_f1)

```





