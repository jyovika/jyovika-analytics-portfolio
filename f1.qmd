---
title: "Do Fast Pit Stops Win F1 Races - or Is It Just Hype?"
editor: visual
---
---
title: "blog"
format: html
editor: visual
---

On lap 37 of the Italian Grand Prix, everything was perfect - clean air, fresh tyres, P1.

Then came the pit stop.
Three seconds too slow.
He rejoined in third.
He never recovered.

In a sport where races last 90 minutes, can three seconds in a pit lane really decide everything?

I used real Formula 1 data to find out — not just with charts, but with statistical modelling, bootstrapping and predictive analysis.

This blog is the investigation.

We’re answering one question:

**Does pit stop speed translate into better race results in a measurable way.**



## Libraries
```{r, libraries, message=FALSE}
library(tidyverse)
library(broom)     
library(rsample)   
```


## Load data
```{r, message=FALSE}

pitstops_df <- read.csv(here::here("data/pit_stops.csv"))

results_df <- read.csv(here::here("data/results.csv"))

race_df <- read.csv(here::here("data/races.csv"))

driver_df <- read.csv(here::here("data/drivers.csv"))

constructor_df <- read.csv(here::here("data/constructors.csv"))

status_df <- read.csv(here::here("data/status.csv"))
```


## Process data
```{r}
drivers_lookup <- driver_df %>%
      mutate(driver_full = paste(forename, surname)) %>%
      select(driverId, driver_full)

races_lookup <- race_df %>%
      mutate(race_full = paste(name, year)) %>%
      select(raceId, race_full, year)

constructors_lookup <- constructor_df %>%
      select(constructorId, constructor_name = name)
    
combined_df <- pitstops_df %>%
  left_join(drivers_lookup, by = "driverId") %>%
  left_join(races_lookup, by = "raceId") %>%
  left_join(
    results_df %>%
      select(raceId, driverId, constructorId, positionOrder, positionText, grid, statusId),
    by = c("raceId", "driverId")) %>%
  
  left_join(constructors_lookup, by = "constructorId") %>%
  left_join(status_df, by = "statusId") %>%
  filter(year %in% c(2011, 2015, 2019, 2024)) %>%
  select(
    driver = driver_full,
    race = race_full,
    year,
    constructor = constructor_name,
    stop,
    lap,
    duration,
    milliseconds,
    positionOrder,
    grid,
    status )

combined_2011 <- combined_df %>%
  filter(year == 2011, milliseconds <= 50000)

combined_2015 <- combined_df %>%
  filter(year == 2015, milliseconds <= 50000)

combined_2019 <- combined_df %>%
  filter(year == 2019, milliseconds <= 50000)

combined_2024 <- combined_df %>%
  filter(year == 2024, milliseconds <= 50000)

```

## Exploratory analysis
```{r}
driver_race_df <- combined_df %>%
  mutate(
    stop_sec = suppressWarnings(as.numeric(duration))) %>%
  drop_na(stop_sec) %>%      
  
  group_by(year, race, driver, constructor, grid, positionOrder) %>%
  summarise(
    best_pit_sec = min(stop_sec, na.rm = TRUE),
    avg_pit_sec  = mean(stop_sec, na.rm = TRUE),
    n_stops      = n(),
    .groups = "drop") %>%
  
  filter(best_pit_sec > 15, best_pit_sec < 60)
```

### Overall distribution (best pit per driver per race, all years):
```{r}
driver_race_df %>%
  ggplot(aes(best_pit_sec)) +
  geom_density(fill = "steelblue", alpha = 0.45) +
  labs(
    title = "Complete pit lane time distribution",
    subtitle = "Most pit cycles fall between 18 and 30 seconds",
    x = "Total pit lane time (seconds)",
    y = "Density"
  ) +
  theme_minimal()
```

## Regression model

```{r}
model_f1 <- lm(
  positionOrder ~ best_pit_sec + grid + constructor,
  data = driver_race_df)

summary(model_f1)

```

```{r, regression_table}

tidy(model_f1, conf.int = TRUE) %>%
  filter(term %in% c("best_pit_sec", "grid")) %>%
  select(term, estimate, conf.low, conf.high, p.value)

```

```{r, regression_plot}
driver_race_df %>%
  ggplot(aes(best_pit_sec, positionOrder)) +
  geom_point(alpha = 0.35, size = 1.4) +
  geom_smooth(method = "lm", se = TRUE, color = "#d62728", size = 1) +
  scale_y_reverse(expand = expansion(mult = c(0.02, 0.05))) +
  
  labs(
    title = "Slower pit stops drag drivers backwards",
    subtitle = "Relationship between total pit time and finishing position",
    x = "Total pit time (seconds)",
    y = "Finishing position (P1 at top)") +
  
  theme_minimal(base_size = 13) +
  theme(
    plot.title = element_text(face = "plain"),
    panel.grid.minor = element_blank())


```

When we fit a regression to finishing position, total pit time turns out to have a measurable, but not overwhelming effect.

For every 1 second added to a stop, the model predicts a driver will finish about 0.08 positions worse on average.

That means a slow stop does not usually destroy a race outright, but it does push a driver backwards.
A three-second delay might cost just a few tenths of a finishing position, but across an entire season those tenths add up. If you lose a quarter of a place here, half a place there, it becomes the difference between P5 in the championship and P7, or between a team bonus and none.

Grid position, by comparison, is far more powerful.

Starting one place further back equates to losing almost half a position at the finish — a much steeper penalty than pit time. This makes intuitive sense: a fast car starting deep in the pack has a lot more work to do, regardless of how fast the crew is.

## Bootstrapping to confirm results

```{r bootstrap}
set.seed(44)

n_boot <- 1000
n <- nrow(driver_race_df)

boot_results <- map_dfr(1:n_boot, function(i) {
  sample_df <- driver_race_df %>% slice_sample(n = n, replace = TRUE)
  
  m <- lm(positionOrder ~ best_pit_sec + grid + constructor, data = sample_df)
  
  tibble(
    id = i,
    beta_pit = coef(m)["best_pit_sec"])
})
```

```{r bootstrap_summary}
boot_results %>%
  summarise(
    mean_est = mean(beta_pit, na.rm = TRUE),
    ci_low = quantile(beta_pit, 0.025, na.rm = TRUE),
    ci_high = quantile(beta_pit, 0.975, na.rm = TRUE)
  )
```

```{r bootstrap_plot}
boot_results %>%
  ggplot(aes(beta_pit)) +
  geom_histogram(bins = 40, fill = "dodgerblue2", alpha = 0.6, color = "white") +
  geom_vline(aes(xintercept = mean(beta_pit)), color = "red", linewidth = 1.2) +
  labs(
    title = "Bootstrap distribution of the pit-time effect",
    subtitle = "Estimated change in finishing position per additional second spent in the pit lane",
    x = "Coefficient for pit time (positions per second)",
    y = "Frequency"
  ) +
  theme_minimal()

```


I bootstrapped the pit stop coefficient 1,000 times in order to check whether the trend was just sample noise or something that holds up under resampling.

The results are very consistent:
• The average effect is roughly 0.083 finishing places lost per extra second in pit lane
• The 95 percent confidence range runs from about 0.03 to 0.14
• Almost every resampled model returned a positive effect size

This confirms that the relationship is stable rather than random.

Slower pit stops are reliably associated with worse finishing positions even after accounting for grid position and constructor.

The effect per second is not massive, but it becomes important in aggregate.
A ten second longer stop is typically worth about 0.8 places, which can be the difference between points and no points at all.

## Run per-season regression

```{r season_models}
season_effects <- driver_race_df %>%
  group_by(year) %>%
  do({
    m <- lm(positionOrder ~ best_pit_sec + grid, data = .)
    tibble(
      beta_pit = coef(m)["best_pit_sec"],
      beta_grid = coef(m)["grid"])
  })

season_effects
```

```{r season_plot}
season_effects %>%
  ggplot(aes(x = factor(year), y = beta_pit, group = 1)) +
  geom_area(fill = "#74add1", alpha = 0.3) +
  geom_line(color = "#1b6ca8", linewidth = 1.5) +
  geom_point(size = 4, color = "#1b6ca8", fill = "white",
             shape = 21, stroke = 1.2) +
  labs(
    title = "How costly is pit-lane time across seasons?",
    subtitle = "Coefficient = finishing positions lost per extra second in the lane",
    x = "Season",
    y = "Positions lost per second") +
  
  theme_minimal(base_size = 13) +
  theme(
    plot.title = element_text(face = "bold", size = 16),
    panel.grid.minor = element_blank(),
    axis.title = element_text(face = "bold"),
    plot.subtitle = element_text(margin = margin(b = 10)))
  
```
